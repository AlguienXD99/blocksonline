<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guardar texto en Firestore</title>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body>
  <h2>Ingrese su contraseña</h2>
  <input type="password" id="passwordInput" placeholder="Contraseña" required>
  <button onclick="login()">Iniciar sesión</button>

  <div id="inputSection" style="display: none;">
    <h2>Ingrese el texto que desea guardar:</h2>
    <textarea id="textInput" placeholder="Escribe algo..." required></textarea><br>
    <button onclick="saveText()">Guardar en Firestore</button>
  </div>

  <h2>Texto Guardado:</h2>
  <div id="displayText"></div>

  <script>
    const firebaseConfig = {
       apiKey: "AIzaSyBuWcUaYo9eah5mehCQ0h8bBnkE_251NKY",
       authDomain: "virtualblocks-b7a52.firebaseapp.com",
       databaseURL: "https://virtualblocks-b7a52-default-rtdb.firebaseio.com",
       projectId: "virtualblocks-b7a52",
       storageBucket: "virtualblocks-b7a52.firebasestorage.app",
       messagingSenderId: "490618182453",
       appId: "1:490618182453:web:93385819c7ff08537d8a7c"
    };
    
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Función para autenticar con contraseña
    function login() {
      const password = document.getElementById("passwordInput").value;
      
      // Autenticación de usuario usando la contraseña
      auth.signInWithEmailAndPassword("unlucky123@blocksonline.net", password)
        .then(() => {
          document.getElementById("inputSection").style.display = "block";  // Muestra el área para agregar texto
        })
        .catch((error) => {
          alert("Contraseña incorrecta.");
        });
    }

    // Función para guardar texto en Firestore
    function saveText() {
      const userText = document.getElementById("textInput").value;
      const userId = auth.currentUser.uid;  // Obtén el ID del usuario autenticado
      
      // Guarda el texto en Firestore
      db.collection("texts").doc(userId).set({
        text: userText
      })
      .then(() => {
        alert("Texto guardado exitosamente.");
        displayText();  // Muestra el texto guardado en la otra página
      })
      .catch((error) => {
        alert("Error al guardar el texto: " + error.message);
      });
    }

    // Función para mostrar el texto guardado
    function displayText() {
      const userId = auth.currentUser.uid;
      db.collection("texts").doc(userId).get()
        .then((doc) => {
          if (doc.exists) {
            document.getElementById("displayText").innerText = doc.data().text;
          } else {
            document.getElementById("displayText").innerText = "No hay texto guardado.";
          }
        })
        .catch((error) => {
          alert("Error al obtener el texto: " + error.message);
        });
    }
  </script>
</body>
</html>
