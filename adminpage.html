<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Admin Panel - BLOCKSONLINE</title>
    <script type="module">
        // Importa Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js";

        // Configura Firebase
        const firebaseConfig = {
  apiKey: "AIzaSyBuWcUaYo9eah5mehCQ0h8bBnkE_251NKY",
  authDomain: "virtualblocks-b7a52.firebaseapp.com",
  databaseURL: "https://virtualblocks-b7a52-default-rtdb.firebaseio.com",
  projectId: "virtualblocks-b7a52",
  storageBucket: "virtualblocks-b7a52.firebasestorage.app",
  messagingSenderId: "490618182453",
  appId: "1:490618182453:web:93385819c7ff08537d8a7c"
};
        // üìå Inicializa Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // üÜî Verificar si el usuario ya est√° autenticado
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById("login").style.display = "none";
                document.getElementById("adminPanel").style.display = "block";
                loadBanner();
            } else {
                document.getElementById("login").style.display = "block";
                document.getElementById("adminPanel").style.display = "none";
            }
        });
        // Verificar la contrase√±a
        async function checkPassword() {
            const inputPassword = document.getElementById("password").value;
            const docRef = doc(db, "config", "adminPassword");
            const docSnap = await getDoc(docRef);

            if (docSnap.exists() && docSnap.data().password === inputPassword) {
                document.getElementById("login").style.display = "none";
                document.getElementById("adminPanel").style.display = "block";
                loadBanner();
            } else {
                alert("Contrase√±a incorrecta");
            }
        }

        // Cargar el banner actual
        async function loadBanner() {
            const docRef = doc(db, "config", "banner");
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) {
                document.getElementById("bannerText").value = docSnap.data().html;
            }
        }

        // Guardar el banner editado
        async function saveBanner() {
            const newBanner = document.getElementById("bannerText").value;
            await setDoc(doc(db, "config", "banner"), { html: newBanner });
            alert("Banner actualizado");
        }

        window.checkPassword = checkPassword;
        window.saveBanner = saveBanner;
    </script>
</head>
<body>

    <h1>Admin Panel - BLOCKSONLINE</h1>

    <div id="login">
        <input type="password" id="password" placeholder="Enter Password">
        <button onclick="checkPassword()">Login</button>
    </div>

    <div id="adminPanel" style="display: none;">
        <h2>Edit Banner</h2>
        <textarea id="bannerText" rows="3" cols="50"></textarea>
        <button onclick="saveBanner()">Save</button>
    </div>

</body>
</html>
